!function(n){var r={};function o(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=n,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=4)}([function(e,t,n){var r=n(1),o=n(2);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var a={insert:"head",singleton:!1},i=(r(o,a),o.locals?o.locals:{});e.exports=i},function(e,t,a){"use strict";var n,r,o=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},i=(r={},function(e){if(void 0===r[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}r[e]=t}return r[e]}),p=[];function f(e){for(var t=-1,n=0;n<p.length;n++)if(p[n].identifier===e){t=n;break}return t}function s(e,t){for(var n={},r=[],o=0;o<e.length;o++){var a=e[o],i=t.base?a[0]+t.base:a[0],l=n[i]||0,s="".concat(i," ").concat(l);n[i]=l+1;var c=f(s),u={css:a[1],media:a[2],sourceMap:a[3]};-1!==c?(p[c].references++,p[c].updater(u)):p.push({identifier:s,updater:v(u,t),references:1}),r.push(s)}return r}function l(e){var t=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var r=a.nc;r&&(n.nonce=r)}if(Object.keys(n).forEach(function(e){t.setAttribute(e,n[e])}),"function"==typeof e.insert)e.insert(t);else{var o=i(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var c,u=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function d(e,t,n,r){var o=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=u(t,o);else{var a=document.createTextNode(o),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(a,i[t]):e.appendChild(a)}}var h=null,y=0;function v(t,e){var n,r,o;if(e.singleton){var a=y++;n=h=h||l(e),r=d.bind(null,n,a,!1),o=d.bind(null,n,a,!0)}else n=l(e),r=function(e,t,n){var r=n.css,o=n.media,a=n.sourceMap;if(o?e.setAttribute("media",o):e.removeAttribute("media"),a&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}.bind(null,n,e),o=function(){var e;null!==(e=n).parentNode&&e.parentNode.removeChild(e)};return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else o()}}e.exports=function(e,i){(i=i||{}).singleton||"boolean"==typeof i.singleton||(i.singleton=o());var l=s(e=e||[],i);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var t=0;t<l.length;t++){var n=f(l[t]);p[n].references--}for(var r=s(e,i),o=0;o<l.length;o++){var a=f(l[o]);0===p[a].references&&(p[a].updater(),p.splice(a,1))}l=r}}}},function(e,t,n){(t=n(3)(!1)).push([e.i,"html,body{height:100%}body{margin:0;background-color:#fffdd0}.centered-horizontally{padding:0;margin:0;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;align-items:center;justify-content:center}.centered{height:100vh;padding:0;margin:0;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;align-items:center;justify-content:center}.player-avatar-image{margin-left:auto;margin-right:auto;display:block}#start-play-button{display:none}.primary-btn{background-color:#28a745}.board{border:1px solid black;margin:2px;margin-left:0;padding:2px;display:inline-block;background:#69c}.board .row{margin:0;padding:0}.board .row .cell{display:inline-block;width:calc(100vw / 4);height:calc(100vh / 4);margin:3px;padding:0;background:#e6e6e6;border:1px solid #999}.board .row .cell:not([player]){cursor:pointer}.board .row .cell:not([player]):hover{background:#d9d9d9}.image-container{display:none}.error-message{display:none;color:red}\n",""]),e.exports=t},function(e,t,n){"use strict";e.exports=function(n){var s=[];return s.toString=function(){return this.map(function(e){var t=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var o=function(e){var t=btoa(unescape(encodeURIComponent(JSON.stringify(e)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(t);return"/*# ".concat(n," */")}(r),a=r.sources.map(function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")});return[n].concat(a).concat([o]).join("\n")}return[n].join("\n")}(e,n);return e[2]?"@media ".concat(e[2]," {").concat(t,"}"):t}).join("")},s.i=function(e,t,n){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(n)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(r[a]=!0)}for(var i=0;i<e.length;i++){var l=[].concat(e[i]);n&&r[l[0]]||(t&&(l[2]?l[2]="".concat(t," and ").concat(l[2]):l[2]=t),s.push(l))}},s}},function(e,t,n){"use strict";n.r(t),n.d(t,"Application",function(){return N});n(0);var r=(o.prototype.switchToPage=function(e,t){var n=this.controllers.get(e);if(!n)throw new Error("Cannot find controller named: "+e);this.activeController&&this.activeController.onHide(),$.mobile.changePage("#page-"+e),n.onShow(t),this.activeController=n},o.prototype.setControllers=function(e){this.controllers=e},o);function o(){}var a=(i.prototype.onShow=function(e){},i.prototype.onHide=function(){},i.prototype.switchToPage=function(e,t){void 0===t&&(t=null),this.router.switchToPage(e,t)},i);function i(e){if(!e)throw new Error("If you overrided the constructor controller, make sure to pass the router in the super call");this.router=e}var l=function(){return(l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},s=function(e,i,l,s){return new(l=l||Promise)(function(n,t){function r(e){try{a(s.next(e))}catch(e){t(e)}}function o(e){try{a(s.throw(e))}catch(e){t(e)}}function a(e){var t;e.done?n(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(r,o)}a((s=s.apply(e,i||[])).next())})},c=function(n,r){var o,a,i,e,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,a&&(i=2&t[0]?a.return:t[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,t[1])).done)return i;switch(a=0,i&&(t=[2&t[0],i.value]),t[0]){case 0:case 1:i=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(i=0<(i=l.trys).length&&i[i.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!i||t[1]>i[0]&&t[1]<i[3])){l.label=t[1];break}if(6===t[0]&&l.label<i[1]){l.label=i[1],i=t;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(t);break}i[2]&&l.ops.pop(),l.trys.pop();continue}t=r.call(n,l)}catch(e){t=[6,e],a=0}finally{o=i=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},u=(p.prototype.takeAvatarPicture=function(){return s(this,void 0,void 0,function(){var r,o,a=this;return c(this,function(e){return r=window.innerWidth&&document.documentElement.clientWidth?Math.min(window.innerWidth,document.documentElement.clientWidth):window.innerWidth||document.documentElement.clientWidth||document.getElementsByTagName("body")[0].clientWidth,o=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight),[2,new Promise(function(t,n){window.navigator.camera.getPicture(function(e){a.avatarBase64Image=e,t(e)},function(e){return n(e)},{allowEdit:!0,targetWidth:r/4,targetHeight:o/4})})]})})},p.fromLocalStorage=function(e){var t=localStorage.getItem("player-"+e);if(!t)return null;try{var n=JSON.parse(t);return new p(l({},n))}catch(e){return null}},p.prototype.saveToLocalStorage=function(){localStorage.setItem("player-"+this.nickName,JSON.stringify({nickName:this.nickName,avatarBase64Image:this.avatarBase64Image}))},p);function p(e){var t=e.playerNumber,n=e.nickName,r=e.avatarBase64Image;this.number=t,this.nickName=n,this.avatarBase64Image=r}var f,d,h,y,v=(f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),g=function(e,i,l,s){return new(l=l||Promise)(function(n,t){function r(e){try{a(s.next(e))}catch(e){t(e)}}function o(e){try{a(s.throw(e))}catch(e){t(e)}}function a(e){var t;e.done?n(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(r,o)}a((s=s.apply(e,i||[])).next())})},m=function(n,r){var o,a,i,e,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,a&&(i=2&t[0]?a.return:t[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,t[1])).done)return i;switch(a=0,i&&(t=[2&t[0],i.value]),t[0]){case 0:case 1:i=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(i=0<(i=l.trys).length&&i[i.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!i||t[1]>i[0]&&t[1]<i[3])){l.label=t[1];break}if(6===t[0]&&l.label<i[1]){l.label=i[1],i=t;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(t);break}i[2]&&l.ops.pop(),l.trys.pop();continue}t=r.call(n,l)}catch(e){t=[6,e],a=0}finally{o=i=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},b=(v(w,d=a),w.prototype.isThereMissingAvatarOnPlayers=function(){return!!this.players.find(function(e){return!e.avatarBase64Image})},w.prototype.onShow=function(e){var t=$(".add-image-button"),n=$(".confirm-nickname"),l=this;n.on("click",function(){var e=parseInt($(this).attr("player")),t=$("#nickname-"+e).val(),n=$("#error-message-"+e);if(""===t)return n.text("Le pseudo ne peut pas être vide.").show();if(t.length<3)return n.text("Le pseudo doit contenir au moins 3 caractères.").show();for(var r=0,o=l.players;r<o.length;r++){var a=o[r];if(a.nickName===t&&a.number!==e)return n.text("Les deux joueurs ne peuvent pas avoir le même pseudo.").show()}n.hide();var i=u.fromLocalStorage(t);null!==i?(i.number=e,l.players[e-1]=i,$("#image-p"+e).attr("src","data:image/png;base64,"+i.avatarBase64Image),l.isThereMissingAvatarOnPlayers()||l.displayStartPlayButton()):l.players[e-1].nickName=t,$("#image-container-"+e).show()}),t.on("click",function(){return g(this,void 0,void 0,function(){var t,n;return m(this,function(e){switch(e.label){case 0:return t=parseInt($(this).attr("player")),[4,l.players[t-1].takeAvatarPicture()];case 1:return n=e.sent(),$("#image-p"+t).attr("src","data:image/png;base64,"+n),l.isThereMissingAvatarOnPlayers()||l.displayStartPlayButton(),[2]}})})})},w.prototype.displayStartPlayButton=function(){var n=this;$("#start-play-button").show().on("click",function(){for(var e=0,t=n.players;e<t.length;e++)t[e].saveToLocalStorage();n.switchToPage("game",n.players)})},w.prototype.onHide=function(){$("#start-play-button").hide().off(),$(".add-image-button").off(),$("#image-p1").attr("src",""),$("#image-p2").attr("src","")},w);function w(e){var t=d.call(this,e)||this;return t.name="home",t.players=[new u({playerNumber:1}),new u({playerNumber:2})],t}(y=h=h||{})[y.VIDE=0]="VIDE",y[y.P1=1]="P1",y[y.P2=2]="P2";var P=(x.prototype.viderGrille=function(){this.cases=[[h.VIDE,h.VIDE,h.VIDE],[h.VIDE,h.VIDE,h.VIDE],[h.VIDE,h.VIDE,h.VIDE]],console.log("Grille vidée : ",this.cases)},x.prototype.getCaseStatus=function(e,t){if(e<0||2<e)throw new Error("X out of range: "+e);if(t<0||2<t)throw new Error("Y out of range: "+t);return this.cases[e][t]},x.prototype.setCaseStatus=function(e,t,n){if(e<0||2<e)throw new Error("X out of range");if(t<0||2<t)throw new Error("Y out of range");return this.cases[e][t]=n,this},x.prototype.getCases=function(){return this.cases},x.prototype.areAllCellsPlayed=function(){for(var e=0,t=this.cases;e<t.length;e++)for(var n=0,r=t[e];n<r.length;n++)if(r[n]===h.VIDE)return!1;return!0},x);function x(){this.viderGrille()}var E,S,k,C,I=(O.prototype.getGrille=function(){return this.grille},O.prototype.playOnCell=function(e,t){this.lastPlay&&2!==this.lastPlay.number?(this.lastPlay=this.players[1],this.grille.setCaseStatus(e,t,h.P2)):(this.lastPlay=this.players[0],this.grille.setCaseStatus(e,t,h.P1))},O.prototype.isCellPlayedByPlayer=function(e,t,n){var r=this.grille.getCaseStatus(e,t);return r!==h.VIDE&&(r===h.P1&&1===n.number||r===h.P2&&2===n.number)},O.prototype.getPlayerFromPlayedCell=function(e,t){return this.grille.getCaseStatus(e,t)===h.P1?this.players[0]:this.players[1]},O.prototype.getWinnerIfExists=function(){for(var o=this,e=0,t=[[[0,0],[0,1],[0,2]],[[1,0],[1,1],[1,2]],[[2,0],[2,1],[2,2]],[[0,0],[1,0],[2,0]],[[0,1],[1,1],[2,1]],[[0,2],[1,2],[2,2]],[[0,0],[1,1],[2,2]],[[0,2],[1,1],[2,0]]];e<t.length;e++){var n=t[e].reduce(function(e,t){var n=t[0],r=t[1];return null===e||o.grille.getCaseStatus(n,r)===h.VIDE||void 0!==e&&!o.isCellPlayedByPlayer(n,r,e)?null:e||o.getPlayerFromPlayedCell(n,r)},void 0);if(n)return n}return null},O);function O(e){this.players=e,this.grille=new P}function _(){var e=null!==S&&S.apply(this,arguments)||this;return e.name="game",e}function j(e){var t=C.call(this,e)||this;return t.name="score",t}var T=[b,((E=function(e,t){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}E(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)})(_,S=a),_.prototype.onShow=function(e){this.game=new I(e),this.displayGrille()},_.prototype.onHide=function(){$(".cell").off()},_.prototype.displayGrille=function(){function e(e,t,n){return n===h.VIDE?'<div x="'+(e+1)+'" y="'+(t+1)+'" class="cell"></div>':'<div x="'+(e+1)+'" y="'+(t+1)+'" player='+(n===h.P1?1:2)+' class="cell"></div>'}var a=this,t=this.game.getGrille().getCases();$("#board-container").html('\n      <div class="board">\n        <div class="row">\n          '+e(0,0,t[0][0])+"\n          "+e(1,0,t[1][0])+"\n          "+e(2,0,t[2][0])+'\n        </div>\n        <div class="row">\n          '+e(0,1,t[0][1])+"\n          "+e(1,1,t[1][1])+"\n          "+e(2,1,t[2][1])+'\n        </div>\n        <div class="row">\n          '+e(0,2,t[0][2])+"\n          "+e(1,2,t[1][2])+"\n          "+e(2,2,t[2][2])+"\n        </div>\n      </div>\n    "),t.map(function(e,o){e.map(function(e,t){if(e!==h.VIDE){var n=$(".cell[x="+(o+1)+"][y="+(t+1)+"]"),r=e===h.P1?a.game.players[0]:a.game.players[1];n.css("background-image",'url("data:image/png;base64,'+r.avatarBase64Image+'")')}})}),this.initClickHandlersForGrille()},_.prototype.initClickHandlersForGrille=function(){var r=this;$(".cell").on("click",function(){var e=$(this),t=parseInt(e.attr("x"))-1,n=parseInt(e.attr("y"))-1;e.attr("player")||(r.game.playOnCell(t,n),r.displayGrille(),r.processNewGameState())})},_.prototype.processNewGameState=function(){var e=this.game.getWinnerIfExists();e?this.router.switchToPage("score",{players:this.game.players,winner:e}):this.game.grille.areAllCellsPlayed()&&this.router.switchToPage("score",{players:this.game.players,winner:null})},_),((k=function(e,t){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}k(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)})(j,C=a),j.prototype.onShow=function(e){var t=e.players,n=e.winner;console.log(t),console.log(n)},j)],N=(D.prototype.initiateControllers=function(){this.router=new r;for(var e=0,t=T;e<t.length;e++){var n=new t[e](this.router);if(!n.name)throw new Error("Controller should have a name property.");this.controllers.set(n.name,n)}this.router.setControllers(this.controllers)},D.prototype.onDeviceReady=function(){var e=this;this.receivedEvent("deviceready"),window.location.hash&&"#page-loading"!==window.location.hash?this.router.switchToPage("home"):setTimeout(function(){e.router.switchToPage("home")},2e3)},D.prototype.receivedEvent=function(e){console.log("[Application#receivedEvent] id = ",e)},D);function D(){this.controllers=new Map,console.log("Hello HelloWorldssss"),document.addEventListener("deviceready",this.onDeviceReady.bind(this),!1),this.initiateControllers()}document.addEventListener("DOMContentLoaded",function(){console.log("jQuery Ready, now instantiate the Application"),new N},!1)}]);